{"ast":null,"code":"/*\nThis file is part of web3.js.\n\nweb3.js is free software: you can redistribute it and/or modify\nit under the terms of the GNU Lesser General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nweb3.js is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License\nalong with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { RLP } from '@ethereumjs/rlp';\nimport { InvalidAddressError, InvalidMethodParamsError, InvalidNumberError, Web3ContractError } from 'web3-errors';\nimport { isNullish, mergeDeep, isContractInitOptions, keccak256, toChecksumAddress, hexToNumber } from 'web3-utils';\nimport { isAddress, isHexString } from 'web3-validator';\nimport { encodeMethodABI } from './encoding.js';\nconst dataInputEncodeMethodHelper = (txParams, abi, params, dataInputFill) => {\n  var _a, _b;\n  const tx = {};\n  if (!isNullish(txParams.data) || dataInputFill === 'both') {\n    tx.data = encodeMethodABI(abi, params, (_a = txParams.data) !== null && _a !== void 0 ? _a : txParams.input);\n  }\n  if (!isNullish(txParams.input) || dataInputFill === 'both') {\n    tx.input = encodeMethodABI(abi, params, (_b = txParams.input) !== null && _b !== void 0 ? _b : txParams.data);\n  }\n  // if input and data is empty, use web3config default\n  if (isNullish(tx.input) && isNullish(tx.data)) {\n    tx[dataInputFill] = encodeMethodABI(abi, params);\n  }\n  return {\n    data: tx.data,\n    input: tx.input\n  };\n};\nexport const getSendTxParams = ({\n  abi,\n  params,\n  options,\n  contractOptions\n}) => {\n  var _a, _b, _c;\n  const deploymentCall = (_c = (_b = (_a = options === null || options === void 0 ? void 0 : options.input) !== null && _a !== void 0 ? _a : options === null || options === void 0 ? void 0 : options.data) !== null && _b !== void 0 ? _b : contractOptions.input) !== null && _c !== void 0 ? _c : contractOptions.data;\n  if (!deploymentCall && !(options === null || options === void 0 ? void 0 : options.to) && !contractOptions.address) {\n    throw new Web3ContractError('Contract address not specified');\n  }\n  if (!(options === null || options === void 0 ? void 0 : options.from) && !contractOptions.from) {\n    throw new Web3ContractError('Contract \"from\" address not specified');\n  }\n  let txParams = mergeDeep({\n    to: contractOptions.address,\n    gas: contractOptions.gas,\n    gasPrice: contractOptions.gasPrice,\n    from: contractOptions.from,\n    input: contractOptions.input,\n    maxPriorityFeePerGas: contractOptions.maxPriorityFeePerGas,\n    maxFeePerGas: contractOptions.maxFeePerGas,\n    data: contractOptions.data\n  }, options);\n  const dataInput = dataInputEncodeMethodHelper(txParams, abi, params, options === null || options === void 0 ? void 0 : options.dataInputFill);\n  txParams = Object.assign(Object.assign({}, txParams), {\n    data: dataInput.data,\n    input: dataInput.input\n  });\n  return txParams;\n};\nexport const getEthTxCallParams = ({\n  abi,\n  params,\n  options,\n  contractOptions\n}) => {\n  if (!(options === null || options === void 0 ? void 0 : options.to) && !contractOptions.address) {\n    throw new Web3ContractError('Contract address not specified');\n  }\n  let txParams = mergeDeep({\n    to: contractOptions.address,\n    gas: contractOptions.gas,\n    gasPrice: contractOptions.gasPrice,\n    from: contractOptions.from,\n    input: contractOptions.input,\n    maxPriorityFeePerGas: contractOptions.maxPriorityFeePerGas,\n    maxFeePerGas: contractOptions.maxFeePerGas,\n    data: contractOptions.data\n  }, options);\n  const dataInput = dataInputEncodeMethodHelper(txParams, abi, params, options === null || options === void 0 ? void 0 : options.dataInputFill);\n  txParams = Object.assign(Object.assign({}, txParams), {\n    data: dataInput.data,\n    input: dataInput.input\n  });\n  return txParams;\n};\nexport const getEstimateGasParams = ({\n  abi,\n  params,\n  options,\n  contractOptions\n}) => {\n  let txParams = mergeDeep({\n    to: contractOptions.address,\n    gas: contractOptions.gas,\n    gasPrice: contractOptions.gasPrice,\n    from: contractOptions.from,\n    input: contractOptions.input,\n    data: contractOptions.data\n  }, options);\n  const dataInput = dataInputEncodeMethodHelper(txParams, abi, params, options === null || options === void 0 ? void 0 : options.dataInputFill);\n  txParams = Object.assign(Object.assign({}, txParams), {\n    data: dataInput.data,\n    input: dataInput.input\n  });\n  return txParams;\n};\nexport const isWeb3ContractContext = options => typeof options === 'object' && !isNullish(options) && Object.keys(options).length !== 0 && !isContractInitOptions(options);\nexport const getCreateAccessListParams = ({\n  abi,\n  params,\n  options,\n  contractOptions\n}) => {\n  if (!(options === null || options === void 0 ? void 0 : options.to) && !contractOptions.address) {\n    throw new Web3ContractError('Contract address not specified');\n  }\n  if (!(options === null || options === void 0 ? void 0 : options.from) && !contractOptions.from) {\n    throw new Web3ContractError('Contract \"from\" address not specified');\n  }\n  let txParams = mergeDeep({\n    to: contractOptions.address,\n    gas: contractOptions.gas,\n    gasPrice: contractOptions.gasPrice,\n    from: contractOptions.from,\n    input: contractOptions.input,\n    maxPriorityFeePerGas: contractOptions.maxPriorityFeePerGas,\n    maxFeePerGas: contractOptions.maxFeePerGas,\n    data: contractOptions.data\n  }, options);\n  const dataInput = dataInputEncodeMethodHelper(txParams, abi, params, options === null || options === void 0 ? void 0 : options.dataInputFill);\n  txParams = Object.assign(Object.assign({}, txParams), {\n    data: dataInput.data,\n    input: dataInput.input\n  });\n  return txParams;\n};\nexport const createContractAddress = (from, nonce) => {\n  if (!isAddress(from)) throw new InvalidAddressError(`Invalid address given ${from}`);\n  let nonceValue = nonce;\n  if (typeof nonce === \"string\" && isHexString(nonce)) nonceValue = hexToNumber(nonce);else if (typeof nonce === \"string\" && !isHexString(nonce)) throw new InvalidNumberError(\"Invalid nonce value format\");\n  const rlpEncoded = RLP.encode([from, nonceValue]);\n  const result = keccak256(rlpEncoded);\n  const contractAddress = '0x'.concat(result.substring(26));\n  return toChecksumAddress(contractAddress);\n};\nexport const create2ContractAddress = (from, salt, initCode) => {\n  if (!isAddress(from)) throw new InvalidAddressError(`Invalid address given ${from}`);\n  if (!isHexString(salt)) throw new InvalidMethodParamsError(`Invalid salt value ${salt}`);\n  if (!isHexString(initCode)) throw new InvalidMethodParamsError(`Invalid initCode value ${initCode}`);\n  const initCodeHash = keccak256(initCode);\n  const initCodeHashPadded = initCodeHash.padStart(64, '0'); // Pad to 32 bytes (64 hex characters)\n  const create2Params = ['0xff', from, salt, initCodeHashPadded].map(x => x.replace(/0x/, ''));\n  const create2Address = `0x${create2Params.join('')}`;\n  return toChecksumAddress(`0x${keccak256(create2Address).slice(26)}`); // Slice to get the last 20 bytes (40 hex characters) & checksum\n};","map":{"version":3,"names":["RLP","InvalidAddressError","InvalidMethodParamsError","InvalidNumberError","Web3ContractError","isNullish","mergeDeep","isContractInitOptions","keccak256","toChecksumAddress","hexToNumber","isAddress","isHexString","encodeMethodABI","dataInputEncodeMethodHelper","txParams","abi","params","dataInputFill","tx","data","_a","input","_b","getSendTxParams","options","contractOptions","deploymentCall","_c","to","address","from","gas","gasPrice","maxPriorityFeePerGas","maxFeePerGas","dataInput","Object","assign","getEthTxCallParams","getEstimateGasParams","isWeb3ContractContext","keys","length","getCreateAccessListParams","createContractAddress","nonce","nonceValue","rlpEncoded","encode","result","contractAddress","concat","substring","create2ContractAddress","salt","initCode","initCodeHash","initCodeHashPadded","padStart","create2Params","map","x","replace","create2Address","join","slice"],"sources":["../../src/utils.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}