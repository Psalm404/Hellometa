{"ast":null,"code":"import Vue from 'vue';\nimport Vuex from 'vuex';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    isLoggedIn: false,\n    token: '',\n    user: null,\n    isAccountMatched: false // 小账号所属检测\n  },\n  mutations: {\n    setLoginStatus(state, status) {\n      state.isLoggedIn = status;\n    },\n    setToken(state, token) {\n      state.token = token;\n    },\n    setUser(state, user) {\n      state.user = user;\n    },\n    setUserAvatar(state, avatarUrl) {\n      if (state.user) {\n        state.user.avatar = avatarUrl;\n      } else {\n        state.user = {\n          avatar: avatarUrl\n        };\n      }\n    },\n    setUserBalance(state, balance) {\n      // 新增的 mutation\n      state.user.balance = balance;\n    },\n    setAccountMatched(state, matched) {\n      state.isAccountMatched = matched;\n    }\n  },\n  actions: {\n    logout({\n      commit\n    }) {\n      // 清除 cookie 中的登录状态、token 和用户信息\n      document.cookie = 'loggedIn=false; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\n      document.cookie = 'token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\n      document.cookie = 'user=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\n      // 更新 Vuex 状态\n      commit('setLoginStatus', false);\n      commit('setToken', '');\n      commit('setUser', null);\n      // 清除 localStorage 中的 account\n      localStorage.removeItem('account');\n      // 清除 localStorage\n      localStorage.removeItem('authToken');\n      localStorage.removeItem('userInfo');\n      localStorage.removeItem('account');\n    },\n    login({\n      commit\n    }, {\n      token,\n      user\n    }) {\n      commit('setLoginStatus', true);\n      commit('setToken', token);\n      commit('setUser', user);\n\n      // 确保这里是将数据存储到 localStorage\n      localStorage.setItem('authToken', token);\n      localStorage.setItem('userInfo', JSON.stringify(user));\n      localStorage.setItem('account', user.account);\n\n      // 可以在这里打印输出看看数据是否正确\n      console.log('Logged in user:', user);\n    },\n    checkLoginStatus({\n      commit\n    }) {\n      const token = localStorage.getItem('authToken');\n      const userInfo = JSON.parse(localStorage.getItem('userInfo'));\n      if (token && userInfo) {\n        commit('setLoginStatus', true);\n        commit('setToken', token);\n        commit('setUser', userInfo);\n      } else {\n        commit('setLoginStatus', false);\n        commit('setToken', '');\n        commit('setUser', null);\n      }\n    },\n    updateUserBalance({\n      commit\n    }, balance) {\n      // 新增的 action\n      commit('setUserBalance', balance);\n    }\n  }\n});","map":{"version":3,"names":["Vue","Vuex","use","Store","state","isLoggedIn","token","user","isAccountMatched","mutations","setLoginStatus","status","setToken","setUser","setUserAvatar","avatarUrl","avatar","setUserBalance","balance","setAccountMatched","matched","actions","logout","commit","document","cookie","localStorage","removeItem","login","setItem","JSON","stringify","account","console","log","checkLoginStatus","getItem","userInfo","parse","updateUserBalance"],"sources":["D:/my-repo/hellometa/src/store.js"],"sourcesContent":["import Vue from 'vue';\r\nimport Vuex from 'vuex';\r\n\r\nVue.use(Vuex);\r\n\r\nexport default new Vuex.Store({\r\n  state: {\r\n    isLoggedIn: false,\r\n    token: '',\r\n    user: null,\r\n    isAccountMatched: false, // 小账号所属检测\r\n  },\r\n  mutations: {\r\n    setLoginStatus(state, status) {\r\n      state.isLoggedIn = status;\r\n    },\r\n    setToken(state, token) {\r\n      state.token = token;\r\n    },\r\n    setUser(state, user) {\r\n      state.user = user;\r\n    },\r\n    setUserAvatar(state, avatarUrl) {\r\n      if (state.user) {\r\n        state.user.avatar = avatarUrl;\r\n      } else {\r\n          state.user = { avatar: avatarUrl }; \r\n      }\r\n    },\r\n    setUserBalance(state, balance) { // 新增的 mutation\r\n      state.user.balance = balance;\r\n    },\r\n    setAccountMatched(state, matched) {\r\n      state.isAccountMatched = matched;\r\n    },\r\n    \r\n  },\r\n  actions: {\r\n    logout({ commit }) {\r\n      // 清除 cookie 中的登录状态、token 和用户信息\r\n      document.cookie = 'loggedIn=false; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\r\n      document.cookie = 'token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\r\n      document.cookie = 'user=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\r\n      // 更新 Vuex 状态\r\n      commit('setLoginStatus', false);\r\n      commit('setToken', '');\r\n      commit('setUser', null);\r\n      // 清除 localStorage 中的 account\r\n      localStorage.removeItem('account');\r\n      // 清除 localStorage\r\n      localStorage.removeItem('authToken');\r\n      localStorage.removeItem('userInfo');\r\n      localStorage.removeItem('account');\r\n    },\r\n    login({ commit }, { token, user }) {\r\n        commit('setLoginStatus', true);\r\n        commit('setToken', token);\r\n        commit('setUser', user);\r\n\r\n\r\n        // 确保这里是将数据存储到 localStorage\r\n        localStorage.setItem('authToken', token);\r\n        localStorage.setItem('userInfo', JSON.stringify(user));\r\n        localStorage.setItem('account', user.account);\r\n\r\n        // 可以在这里打印输出看看数据是否正确\r\n        console.log('Logged in user:', user);\r\n    },\r\n    checkLoginStatus({ commit }) {\r\n        const token = localStorage.getItem('authToken');\r\n        const userInfo = JSON.parse(localStorage.getItem('userInfo'));\r\n\r\n        if (token && userInfo) {\r\n            commit('setLoginStatus', true);\r\n            commit('setToken', token);\r\n            commit('setUser', userInfo);\r\n        } else {\r\n            commit('setLoginStatus', false);\r\n            commit('setToken', '');\r\n            commit('setUser', null);\r\n        }\r\n    },\r\n    updateUserBalance({ commit }, balance) { // 新增的 action\r\n      commit('setUserBalance', balance);\r\n    },\r\n  },\r\n});"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}